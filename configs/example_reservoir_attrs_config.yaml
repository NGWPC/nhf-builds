# ======================================================
# CONFIG FOR RESERVOIRS & WATERBODIES

## the source files and reference files can be found in S3 data account.
## Please refer to /docs/builds.reservoir_attrs.md for more information and the files paths.
# ======================================================



# -----------------------------
# GENERAL CONFIGS
# -----------------------------
crs:
  default_src_crs: "EPSG:4326"
  work_crs: "EPSG:5070"     # projected ops, distances, buffers. area-equal crs for SuperCONUS

network:
  http:
    timeout_secs: 30
    retries: 3
    backoff: 0.75

roots:
  reservoirs_dir: "/home/farshid.rahmani/Documents/Dataset/reservoirs"
  output_dir: "/home/farshid.rahmani/Documents/Dataset/reservoirs/outputs"

# -----------------------------
# INPUT DATASETS
# -----------------------------
inputs:
  nid:
    path: "{reservoirs_dir}/source_files/NID2019_U.csv"
    src_crs: "EPSG:4326"
    output_crs: "EPSG:5070"
    drop_states: ["AK", "HI", "PR", "GU"]


  reference_waterbodies:
    path: "{reservoirs_dir}/reference_reservoirs/reference_waterbodies.gpkg"
    layer: "reference_waterbodies"
    src_crs: null
    output_crs: "EPSG:5070"
    id_col: "comid"



  reference_reservoirs:
    path: "{reservoirs_dir}/reference_reservoirs/reference-reservoirs-v1.gpkg"
    layer: "reference-reservoirs-v1"
    src_crs: null
    output_crs: "EPSG:5070"
    distance_to_fp_col: "distance_to_fp_m"
    wb_area_col: "wb_areasqkm"
    ref_wb_id_col: "ref_fab_wb"
    min_wb_area_sqkm: 0.2
    max_distance_m: 1000    # max distance of reference reservoir points from column "distance_to_fp_m"

  # OPTIONAL: per-state OSM builds that you may have produced with osmextract
  osm_build:
    path: "{reservoirs_dir}/source_files/osm_dams_all.gpkg"
    layer: "osm_dams_all"
    filter_col: "waterway"    # column's name which has dam and non-dam infrastructures
    filter_val: "dam"        # value used to filter


# -----------------------------
# DEM / ELEVATION
# -----------------------------
dem:
  path: "/home/farshid.rahmani/Downloads/USGS_Seamless_DEM_13.vrt"  # VRT mosaic
  prefer_crs_of_dem: true   # reproject polygons to DEM CRS before sampling
  band: 1
  nodata: null              # let rasterio infer if null


# -----------------------------
# RFC_DA
# -----------------------------
rfc_da:
  outputs:
    out_gpkg: "{output_dir}/rfc_da_hydraulics.gpkg"


# -----------------------------
# MATCHING / NEAREST RULES
# -----------------------------
matching:
  max_waterbody_nearest_dist_m: 1000   # for nearest WB â†” dam selection
  min_area_sqkm: 0.2   # removes waterbodies smaller than this threshold. None: does not exclude any waterbody
